# 邻·生活 - 本地生活服务平台

## 📱 项目概述

"邻·生活"是一个基于微信小程序的本地生活服务平台，专注于连接用户与本地商家，提供便捷的餐饮外卖、生活服务等功能。

### 🎯 核心功能
- **餐饮外卖**: 商家入驻、菜品管理、在线下单、配送跟踪
- **积分系统**: 消费奖励、签到积分、积分商城、会员等级
- **社区服务**: 本地商家推荐、用户评价、优惠活动
- **智能配送**: 配送员管理、实时跟踪、配送优化

## 🏗️ 技术架构

### 后端技术栈
- **框架**: Node.js + Koa2
- **数据库**: MySQL + Sequelize ORM
- **缓存**: Redis
- **支付**: 微信支付SDK
- **部署**: Docker + 微信云托管

### 前端技术栈
- **小程序**: 微信小程序原生开发
- **管理后台**: React + Ant Design + ECharts
- **状态管理**: 全局状态管理
- **组件库**: 自定义组件库

## 📊 项目进展

### ✅ 已完成功能

#### 🔧 后端开发
- [x] **项目架构**: Koa2框架 + 中间件配置
- [x] **数据模型**: 25个完整的数据库模型和关联关系
- [x] **用户认证**: JWT认证、微信登录、手机绑定
- [x] **商家管理**: 商家入驻、信息管理、营业状态
- [x] **订单系统**: 完整的订单生命周期管理
- [x] **支付集成**: 微信支付、支付回调、退款处理
- [x] **积分系统**: 签到奖励、消费返积分、积分记录

#### 📱 小程序前端
- [x] **首页开发**: 位置服务、商家展示、分类导航
- [x] **商家详情**: 菜品展示、购物车、规格选择
- [x] **订单管理**: 订单列表、状态跟踪、操作功能
- [x] **组件库**: 通用组件（导航栏、加载器、空状态等）
- [x] **全局状态**: 购物车管理、用户状态管理

#### 🎨 UI/UX设计
- [x] **设计系统**: 统一的颜色、字体、间距规范
- [x] **响应式设计**: 适配不同屏幕尺寸
- [x] **交互体验**: 加载状态、空状态、错误处理
- [x] **用户体验**: 下拉刷新、上拉加载、无限滚动

### 🚧 开发中功能

#### 🎁 积分系统优化
- [ ] 积分商城页面
- [ ] 会员等级系统
- [ ] 积分明细查看
- [ ] 积分兑换功能

### 📋 待开发功能

#### 🚚 配送系统
- [ ] 配送员管理界面
- [ ] 实时位置跟踪
- [ ] 配送路径优化
- [ ] 推送消息通知

#### 💼 管理后台
- [ ] React管理后台搭建
- [ ] 数据可视化图表
- [ ] 商家管理功能
- [ ] 订单统计分析

## 🗂️ 项目结构

```
xcx/
├── backend/                    # 后端服务
│   ├── app.js                 # 应用入口
│   ├── config/                # 配置文件
│   │   ├── database.js        # 数据库配置
│   │   ├── redis.js           # Redis配置
│   │   └── settings.js        # 应用设置
│   ├── controllers/           # 控制器
│   │   ├── authController.js  # 认证控制器
│   │   ├── merchantController.js # 商家控制器
│   │   ├── orderController.js # 订单控制器
│   │   └── paymentController.js # 支付控制器
│   ├── middleware/            # 中间件
│   │   ├── auth.js           # 认证中间件
│   │   ├── errorHandler.js   # 错误处理
│   │   ├── rateLimit.js      # 限流中间件
│   │   └── validation.js     # 参数验证
│   ├── models/               # 数据模型
│   │   ├── User.js          # 用户模型
│   │   ├── Merchant.js      # 商家模型
│   │   ├── Order.js         # 订单模型
│   │   └── ... (共25个模型)
│   ├── routes/              # 路由
│   │   ├── auth.js         # 认证路由
│   │   ├── merchants.js    # 商家路由
│   │   ├── orders.js       # 订单路由
│   │   └── payment.js      # 支付路由
│   └── utils/              # 工具函数
│       ├── jwt.js         # JWT工具
│       └── logger.js      # 日志工具
│
├── miniprogram/              # 小程序前端
│   ├── app.js               # 小程序入口
│   ├── app.json             # 小程序配置
│   ├── components/          # 组件库
│   │   ├── custom-navbar/   # 自定义导航栏
│   │   ├── loading/         # 加载组件
│   │   ├── empty/           # 空状态组件
│   │   └── merchant-card/   # 商家卡片
│   ├── pages/               # 页面
│   │   ├── index/           # 首页
│   │   ├── merchant/        # 商家相关页面
│   │   │   └── detail/      # 商家详情
│   │   └── order/           # 订单相关页面
│   │       └── list/        # 订单列表
│   └── utils/               # 工具函数
│       └── api.js          # API接口封装
│
└── README.md               # 项目说明
```

## 🎮 核心功能演示

### 🏠 首页功能
- **位置服务**: 自动获取用户位置，推荐附近商家
- **商家展示**: 卡片式商家列表，包含评分、距离、配送费
- **下拉刷新**: 支持下拉刷新数据
- **无限滚动**: 上拉加载更多商家

### 🏪 商家详情
- **商家信息**: 展示商家封面、评分、配送信息
- **菜品分类**: 横向滚动分类导航
- **菜品展示**: 图文并茂的菜品列表
- **购物车**: 实时购物车管理，支持规格选择
- **结算功能**: 起送金额验证，跳转确认页面

### 📋 订单管理
- **订单列表**: 分状态展示订单（全部、待付款、配送中等）
- **订单详情**: 完整订单信息展示
- **订单操作**: 支付、取消、确认收货、评价等
- **再来一单**: 快速重新下单功能

## 🔐 用户认证与安全

### 认证流程
1. **微信登录**: 使用微信code换取session
2. **JWT令牌**: 生成访问令牌和刷新令牌
3. **手机绑定**: 短信验证绑定手机号
4. **权限验证**: 中间件验证用户权限

### 积分奖励
- **注册奖励**: 新用户注册获得100积分
- **绑定手机**: 绑定手机号获得50积分
- **每日签到**: 连续签到有额外奖励
- **消费返积分**: 订单金额1%返积分
- **评价奖励**: 订单评价获得5积分

## 💳 支付系统

### 微信支付集成
- **统一下单**: 生成微信支付订单
- **支付参数**: 安全的支付参数生成
- **回调处理**: 支付结果异步通知处理
- **退款处理**: 支持订单退款功能

### 订单状态管理
- **pending**: 待付款
- **paid**: 已付款
- **confirmed**: 商家确认
- **preparing**: 制作中
- **delivering**: 配送中
- **completed**: 已完成
- **cancelled**: 已取消

## 🚀 部署方案

### 开发环境
```bash
# 后端服务
cd backend
npm install
npm run dev

# 小程序开发
# 使用微信开发者工具打开miniprogram目录
```

### 生产环境
- **服务器**: 微信云托管
- **数据库**: 云数据库MySQL
- **缓存**: 云缓存Redis
- **CDN**: 静态资源CDN加速

## 📈 性能优化

### 前端优化
- **组件复用**: 高度复用的组件库
- **懒加载**: 图片和页面懒加载
- **本地缓存**: 合理使用本地存储
- **请求优化**: 接口请求合并和缓存

### 后端优化
- **数据库索引**: 关键字段建立索引
- **Redis缓存**: 热点数据缓存
- **接口限流**: 防止恶意请求
- **日志监控**: 完善的日志和监控体系

## 🎯 下一步计划

### Phase 1: 积分系统完善 (进行中)
- [ ] 积分商城开发
- [ ] 会员等级系统
- [ ] 积分使用规则

### Phase 2: 配送系统
- [ ] 配送员端开发
- [ ] 实时跟踪功能
- [ ] 智能派单算法

### Phase 3: 管理后台
- [ ] React后台框架
- [ ] 数据统计分析
- [ ] 商家管理功能

### Phase 4: 功能扩展
- [ ] 优惠券系统
- [ ] 团购功能
- [ ] 社区互动

## 🤝 贡献指南

欢迎提交Issue和Pull Request来帮助改进项目。

### 开发规范
- 代码风格: ESLint + Prettier
- 提交规范: Conventional Commits
- 分支管理: Git Flow

## 📄 许可证

MIT License

## 📞 联系方式

如有问题或建议，请通过以下方式联系：
- Email: your-email@example.com
- 微信: your-wechat-id

---

**邻·生活团队** ❤️ 